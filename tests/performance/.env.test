# ============================================================================
# Performance Test Environment Configuration
# ============================================================================
# This .env file is used with docker-compose-test.yaml to run a production-like
# environment locally for Locust performance testing.
#
# Usage:
#   docker compose -f docker-compose-test.yaml --env-file .env.test up -d
#
# ============================================================================

# ============================================================================
# Database Configuration
# ============================================================================
DB_NAME=revel_perf
DB_USER=revel_user
DB_PASSWORD=revel_perf_password
DB_HOST=pgbouncer
DB_PORT=6432
DB_USE_PGBOUNCER=True
DB_CONN_MAX_AGE=0
DB_CONN_HEALTH_CHECKS=False

# ============================================================================
# Redis Configuration
# ============================================================================
REDIS_HOST=redis
REDIS_PORT=6379

# ============================================================================
# Django Core Configuration
# ============================================================================
SECRET_KEY=perf-test-secret-key-not-for-production
SALT_KEY=perf-test-salt-key-not-for-production
DEBUG=True
DEMO_MODE=False
ALLOWED_HOSTS=*
ADMIN_URL=admin/

# System testing mode: exposes tokens in response headers
SYSTEM_TESTING=True

# ============================================================================
# Site Configuration
# ============================================================================
SITE_NAME="Revel Perf Test"
SITE_DOMAIN=localhost:8000
BASE_URL=http://localhost:8000
FRONTEND_BASE_URL=http://localhost:3000

# ============================================================================
# Email Configuration (Mailpit)
# ============================================================================
EMAIL_HOST=mailpit
EMAIL_PORT=1025
EMAIL_HOST_USER=
EMAIL_HOST_PASSWORD=
EMAIL_USE_SSL=False
EMAIL_USE_TLS=False
DEFAULT_FROM_EMAIL="Revel <noreply@test.com>"
INTERNAL_CATCHALL_EMAIL=internal@test.com
EMAIL_DRY_RUN=False

# ============================================================================
# Celery Configuration
# ============================================================================
CELERY_REDIS_DB=0
CELERY_TASK_ALWAYS_EAGER=False

# ============================================================================
# JWT & Authentication
# ============================================================================
JWT_ALGORITHM=HS256
JWT_AUDIENCE=letsrevel.io
ACCESS_TOKEN_LIFETIME_HOURS=1
REFRESH_TOKEN_LIFETIME_DAYS=30
VERIFY_TOKEN_LIFETIME_MINUTES=15
UNSUBSCRIBE_TOKEN_LIFETIME_DAYS=30
ACCOUNT_OTP_EXPIRATION_MINUTES=5
TOTP_ISSUER_NAME=Revel

# ============================================================================
# Stripe Payment Configuration (Disabled for perf tests)
# ============================================================================
# Leave these empty to disable Stripe integration during perf tests
STRIPE_ACCOUNT=
STRIPE_SECRET_KEY=
STRIPE_PUBLISHABLE_KEY=
STRIPE_WEBHOOK_SECRET=
DEFAULT_CURRENCY=EUR
DEFAULT_PLATFORM_FEE_PERCENT=3.00
DEFAULT_PLATFORM_FEE_FIXED=0.50
PAYMENT_DEFAULT_EXPIRY_MINUTES=45
CONNECTED_TEST_STRIPE_ID=

# ============================================================================
# Telegram Bot Configuration (Disabled for perf tests)
# ============================================================================
TELEGRAM_BOT_TOKEN=
TELEGRAM_SUPERUSER_IDS=
TELEGRAM_STAFF_IDS=
TELEGRAM_OTP_EXPIRATION_MINUTES=15
AIOGRAM_REDIS_DB=1

# ============================================================================
# LLM Configuration (Disabled for perf tests)
# ============================================================================
# Leave empty - questionnaires use MANUAL evaluation mode
LLM_DEFAULT_MODEL=ollama/llama3.1:8b
LLM_API_KEY=

# ============================================================================
# Security & File Uploads
# ============================================================================
CLAMAV_HOST=clamav
CLAMAV_PORT=3310

# ============================================================================
# Geo & Location Services
# ============================================================================
IP2LOCATION_TOKEN=

# ============================================================================
# Notifications
# ============================================================================
NOTIFICATION_RETENTION_DAYS=90

# ============================================================================
# Observability Configuration (Disabled for perf tests)
# ============================================================================
ENABLE_OBSERVABILITY=False
SERVICE_NAME=revel-perf
DEPLOYMENT_ENVIRONMENT=performance-test
HOSTNAME=revel-perf-test

# ============================================================================
# Silk Profiling (DISABLED for performance tests)
# ============================================================================
SILK_PROFILER=False

# ============================================================================
# Throttling (DISABLED for performance tests)
# ============================================================================
DISABLE_THROTTLING=True

# ============================================================================
# Locust Performance Test Configuration
# ============================================================================
# These settings are read by the Locust test scripts (not Django)

# Backend API URL (from Locust's perspective - running on host)
LOCUST_BACKEND_URL=http://localhost:8000/api

# Mailpit URL for email verification
LOCUST_MAILPIT_URL=http://localhost:8025

# Default password for test users (must pass Django validators)
LOCUST_DEFAULT_PASSWORD=PerfTest-2026-Secure!

# Number of pre-seeded users (increase for heavy checkout load)
LOCUST_NUM_PRESEEDED_USERS=500

# Ticket tier capacity (increase for continuous checkout testing)
LOCUST_TICKET_TIER_CAPACITY=10000

# Email polling settings (seconds)
LOCUST_EMAIL_POLL_TIMEOUT=10
LOCUST_EMAIL_POLL_INTERVAL=0.5

# Request timeout (seconds)
LOCUST_REQUEST_TIMEOUT=30
